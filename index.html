<!DOCTYPE HTML>
<html>
<head>
	<meta charset="UTF-8">
	<title>Main</title>
	<style>html,head,body { padding:0; margin:0; }
	body { font-family: calibri, helvetica, arial, sans-serif; }
	</style>
</head>
<body>
<div id="page"></div>
<script src="./elm.js"></script>
<script type="text/javascript">
	const app = Elm.Main.embed(document.getElementById('page'), {
		hash: location.hash,
		token: localStorage.getItem("token")
	});
	window.onhashchange = sendHash;
	setTimeout(sendHash);
	function sendHash() {
		const token = localStorage.getItem("token");
		app.ports.hashchanges.send([location.hash, token]);
	}
	app.ports.goto.subscribe(hash => {
		location.hash = hash;
		sendHash();
	});
	app.ports.login.subscribe(token => {
		localStorage.setItem("token", token);
		location.hash = "";
		sendHash();
	});
	app.ports.logout.subscribe(() => {
		localStorage.removeItem("token");
		location.hash = "";
		sendHash();
	});
</script>
</body>
</html>